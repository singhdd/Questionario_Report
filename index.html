<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Questionario Report QlikView - Goline IT Services</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
:root {
  --teal: #0d95a8;
  --dark: #2c3e50;
  --light: #f8fafb;
  --accent: #00b4cc;
  --error: #ef4444;
  --shadow-sm: 0 2px 8px rgba(13,149,168,0.08);
  --shadow-md: 0 8px 24px rgba(13,149,168,0.12);
  --shadow-lg: 0 16px 48px rgba(13,149,168,0.18);
}

* { margin:0; padding:0; box-sizing:border-box; }
body {
  font-family: 'Outfit', sans-serif;
  background: linear-gradient(135deg, #f8fafb, #e8f4f6);
  color: var(--dark);
  min-height: 100vh;
  padding: 2rem 1rem;
  position: relative;
}

body::before, body::after {
  content: '';
  position: fixed;
  border-radius: 50%;
  pointer-events: none;
  z-index: 0;
}

body::before {
  top: -50%; right: -10%;
  width: 600px; height: 600px;
  background: radial-gradient(circle, rgba(13,149,168,0.08), transparent 70%);
}
body::after {
  bottom: -30%; left: -10%;
  width: 500px; height: 500px;
  background: radial-gradient(circle, rgba(0,180,204,0.06), transparent 70%);
}

.container { max-width:780px; margin:0 auto; position: relative; z-index:1; }

.header { text-align:center; margin-bottom:3rem; }
.logo-container {
  background:white; padding:2rem; border-radius:16px;
  box-shadow: var(--shadow-md); margin-bottom:2rem; display:inline-block;
}
.logo-container h1 { color: var(--teal); font-size:2.5rem; margin:0; }
.logo-container p { color: var(--dark); font-size:1.25rem; margin-top:0.5rem; font-weight:400; }
h1 { font-size:2rem; font-weight:700; color: var(--teal); margin-bottom:0.75rem; }
.subtitle { font-size:1.1rem; color:#64748b; font-weight:400; line-height:1.6; }

.form-card {
  background:white; border-radius:20px; padding:3rem;
  box-shadow: var(--shadow-lg);
}
.form-section { margin-bottom:3rem; }

.section-title {
  font-size:0.85rem; font-weight:600; text-transform:uppercase;
  letter-spacing:0.08em; color: var(--teal); margin-bottom:1rem;
  display:flex; align-items:center; gap:0.5rem;
}
.section-number {
  display:inline-flex; align-items:center; justify-content:center;
  width:24px; height:24px; background: var(--teal); color:white; border-radius:50%;
  font-size:0.75rem; font-weight:700;
}

label { display:block; font-size:1.1rem; font-weight:500; color: var(--dark); margin-bottom:1rem; }
.required { color: var(--error); margin-left:0.25rem; font-weight:700; }

input[type="text"], input[type="email"], textarea {
  width:100%; padding:1rem 1.25rem; font-size:1.05rem;
  border:2px solid #e2e8f0; border-radius:10px; background:#fafbfc;
  transition: all 0.3s ease;
}
textarea { resize:vertical; min-height:120px; line-height:1.6; }
input:focus, textarea:focus { outline:none; border-color:var(--teal); background:white; box-shadow:0 0 0 4px rgba(13,149,168,0.1); }

input.error, textarea.error { border-color: var(--error); background:#fef2f2; }
.error-message { color: var(--error); font-size:0.9rem; margin-top:0.5rem; display:none; font-weight:500; }
.error-message.show { display:block; animation:shake 0.4s ease; }

.input-row { display:grid; grid-template-columns:1fr 1fr; gap:1rem; }

.checkbox-group { display:grid; gap:1rem; margin-top:0.5rem; }
.checkbox-item {
  display:flex; align-items:center; padding:1.125rem 1.25rem; background:#fafbfc;
  border:2px solid #e2e8f0; border-radius:10px; cursor:pointer; transition: all 0.3s ease; position:relative;
}
.checkbox-item:hover { border-color:var(--teal); background:white; transform:translateX(4px); }
.checkbox-item input[type="checkbox"] { width:22px; height:22px; margin-right:1rem; accent-color:var(--teal); }
.checkbox-item input:checked + label { font-weight:600; }
.checkbox-item:has(input:checked) { background: rgba(13,149,168,0.05); border-color:var(--teal); }

.altro-reparto-container {
  margin-top:1rem; padding:1.5rem; background: rgba(13,149,168,0.05);
  border:2px solid var(--teal); border-radius:10px; display:none;
}

.helper-text { font-size:0.95rem; color:#64748b; margin-bottom:1rem; font-weight:400; }

.report-inputs { display:flex; flex-direction:column; gap:1rem; margin-top:1rem; }
.report-input-wrapper { display:flex; align-items:center; gap:1rem; }
.report-number { display:inline-flex; align-items:center; justify-content:center; min-width:42px; height:42px;
  background: var(--teal); color:white; border-radius:8px; font-weight:700; font-size:1rem; }
.report-inputs.error .report-input-wrapper:first-child .report-input { border-color: var(--error); background:#fef2f2; }

.submit-section { margin-top:3rem; text-align:center; }
button[type="submit"] {
  padding:1.25rem 3rem; font-size:1.15rem; font-weight:600; color:white;
  background: linear-gradient(135deg,var(--teal),var(--accent)); border:none;
  border-radius:12px; cursor:pointer; box-shadow:var(--shadow-md); text-transform:uppercase;
  transition: all 0.3s ease;
}
button[type="submit"]:hover { transform:translateY(-2px); box-shadow: var(--shadow-lg); }
button[type="submit"]:disabled { opacity:0.6; cursor:not-allowed; transform:none; }

.success-message { background:white; border-radius:20px; padding:4rem 3rem;
  box-shadow:var(--shadow-lg); text-align:center; display:none; }
.success-message h2 { font-size:2rem; color: var(--teal); margin-bottom:1rem; }
.success-message p { font-size:1.1rem; color:#64748b; line-height:1.6; }

.validation-summary { background:#fef2f2; border:2px solid var(--error); border-radius:12px; padding:1.5rem; margin-bottom:2rem; display:none; }
.validation-summary.show { display:block; animation:slideIn 0.4s ease; }
.validation-summary h3 { color:var(--error); font-size:1.1rem; margin-bottom:1rem; font-weight:600; }
.validation-summary ul { list-style:none; padding:0; }
.validation-summary li { color:var(--error); font-size:0.95rem; margin-bottom:0.5rem; padding-left:1.5rem; position:relative; }
.validation-summary li::before { content:'•'; position:absolute; left:0.5rem; font-weight:700; }

@keyframes shake { 0%,100%{transform:translateX(0);} 25%{transform:translateX(-10px);} 75%{transform:translateX(10px);} }
@keyframes slideIn { from{opacity:0; transform:translateX(-20px);} to{opacity:1; transform:translateX(0);} }

@media (max-width:640px) {
  .form-card { padding:2rem 1.5rem; }
  .input-row { grid-template-columns:1fr; }
  h1 { font-size:1.5rem; }
  .logo-container h1 { font-size:2rem; }
  .logo-container p { font-size:1rem; }
  button[type="submit"] { width:100%; }
}
</style>
</head>
<body>

<div class="container">
  <div class="header">
    <div class="logo-container">
      <h1>goline</h1>
      <p>IT Services</p>
    </div>
    <h1>Questionario Report QlikView per Reparto</h1>
    <p class="subtitle">Aiutaci a identificare i 5 report QlikView più utilizzati e importanti nel tuo reparto, che verranno successivamente migrati su Power BI</p>
  </div>

  <div class="form-card" id="formCard">
    <div class="validation-summary" id="validationSummary">
      <h3>⚠️ Compila i seguenti campi obbligatori:</h3>
      <ul id="validationList"></ul>
    </div>

    <form id="reportForm">
      <!-- Sezioni del form (stesse come originali) -->
      <!-- Personal Info, Contatto, Reparti, Report, Note -->
    </form>
  </div>

  <div class="success-message" id="successMessage">
    <h2>✓ Questionario Inviato con Successo!</h2>
    <p>Grazie per aver completato il questionario. Le tue risposte sono state registrate.</p>
  </div>
</div>

<script>
// JS ottimizzato per gestione errori, checkbox "Altro" e invio form
const form = document.getElementById('reportForm');
const successMessage = document.getElementById('successMessage');
const validationSummary = document.getElementById('validationSummary');
const validationList = document.getElementById('validationList');

function clearErrors() {
  document.querySelectorAll('.error').forEach(el => el.classList.remove('error'));
  document.querySelectorAll('.error-message').forEach(el => el.classList.remove('show'));
  validationSummary.classList.remove('show');
  validationList.innerHTML = '';
}

document.getElementById('altro-reparto')?.addEventListener('change', e => {
  const container = document.getElementById('altroRepartoContainer');
  container.style.display = e.target.checked ? 'block' : 'none';
  if(!e.target.checked) document.getElementById('altroRepartoTesto').value = '';
});

form.addEventListener('submit', e => {
  e.preventDefault();
  clearErrors();
  const errors = [];
  const nome = document.getElementById('nome').value.trim();
  const cognome = document.getElementById('cognome').value.trim();
  const email = document.getElementById('email').value.trim();
  const report1 = document.getElementById('report1').value.trim();
  const repartiChecked = Array.from(document.querySelectorAll('input[name="reparti"]:checked')).map(cb => cb.value);

  if(!nome){ errors.push('Nome'); document.getElementById('nome').classList.add('error'); document.getElementById('nomeError').classList.add('show'); }
  if(!cognome){ errors.push('Cognome'); document.getElementById('cognome').classList.add('error'); document.getElementById('cognomeError').classList.add('show'); }
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  if(!email || !emailRegex.test(email)){ errors.push('Email valida'); document.getElementById('email').classList.add('error'); document.getElementById('emailError').classList.add('show'); }
  if(repartiChecked.length===0){ errors.push('Almeno un reparto'); document.getElementById('repartiGroup').classList.add('error'); document.getElementById('repartiError').classList.add('show'); }
  if(document.getElementById('altro-reparto')?.checked && !document.getElementById('altroRepartoTesto').value.trim()){ errors.push('Specifica il nome del reparto in "Altro"'); document.getElementById('altroRepartoTesto').classList.add('error'); }
  if(!report1){ errors.push('Almeno il primo report'); document.getElementById('reportInputs').classList.add('error'); document.getElementById('reportsError').classList.add('show'); }

  if(errors.length){
    errors.forEach(err => { const li = document.createElement('li'); li.textContent = err; validationList.appendChild(li); });
    validationSummary.classList.add('show');
    window.scrollTo({ top:0, behavior:'smooth' });
    return;
  }

  // Raccogli dati
  const data = {
    nome, cognome, email, reparti: repartiChecked,
    altroReparto: document.getElementById('altroRepartoTesto')?.value.trim(),
    reports: Array.from({length:5},(_,i)=>document.getElementById(`report${i+1}`)?.value.trim()),
    note: document.getElementById('note')?.value.trim(),
    timestamp: new Date().toISOString()
  };

  form.querySelector('button[type="submit"]').disabled = true;

  // Invia dati a Google Sheets (no-cors)
  fetch('https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec', {
    method:'POST', mode:'no-cors', headers:{'Content-Type':'application/json'}, body:JSON.stringify(data)
  }).finally(()=>{
    document.getElementById('formCard').style.display='none';
    successMessage.style.display='block';
    window.scrollTo({ top:0, behavior:'smooth' });
  });
});

// Toggle checkbox click
document.querySelectorAll('.checkbox-item').forEach(item=>{
  item.addEventListener('click', e=>{
    if(e.target.tagName!=='INPUT'){
      const cb = item.querySelector('input[type="checkbox"]');
      cb.checked=!cb.checked; cb.dispatchEvent(new Event('change'));
    }
  });
});
</script>

</body>
</html>
